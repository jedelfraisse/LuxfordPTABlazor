@using LuxfordPTAWeb.Client.Services
@inject GoogleAnalyticsService GoogleAnalyticsService
@implements IDisposable

@code {
    private bool hasInitialized = false;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && !hasInitialized)
        {
            hasInitialized = true;
            // Initialize consent management for Google Analytics (gtag already loaded in HTML)
            await GoogleAnalyticsService.InitializeAsync();
        }
    }
    
    public void Dispose()
    {
        // The GoogleAnalyticsService will handle its own disposal
    }
}